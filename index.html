<!DOCTYPE html>
<html dir="rtl" lang="he">

<head>
  <title>מתכנן מסלולי רכיבה</title>
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' fill='%2387CEEB'/%3E%3Cpolygon points='4,48 14,26 24,48' fill='%23E0E0E0'/%3E%3Cpolygon points='20,48 30,24 40,48' fill='%23D8D8D8'/%3E%3Cpolygon points='38,48 48,26 58,48' fill='%23D0D0D0'/%3E%3Cpolygon points='0,48 12,22 28,48' fill='%23D3D3D3'/%3E%3Cpolygon points='28,48 46,16 64,48' fill='%23D3D3D3'/%3E%3Cpolygon points='42,24 46,16 50,24 48,22 46,23 44,22' fill='white'/%3E%3Crect y='48' width='64' height='16' fill='%2332CD32'/%3E%3Ccircle cx='44' cy='50' r='6' stroke='black' stroke-width='1.8' fill='none'/%3E%3Ccircle cx='20' cy='50' r='6' stroke='black' stroke-width='1.8' fill='none'/%3E%3Cline x1='44' y1='50' x2='36' y2='40' stroke='black' stroke-width='1.5'/%3E%3Cline x1='36' y1='40' x2='20' y2='50' stroke='black' stroke-width='1.5'/%3E%3Cline x1='36' y1='40' x2='36' y2='33' stroke='black' stroke-width='1.5'/%3E%3Cline x1='36' y1='33' x2='40' y2='33' stroke='black' stroke-width='1.2'/%3E%3Cline x1='36' y1='33' x2='29' y2='30' stroke='black' stroke-width='1.5'/%3E%3Cline x1='29' y1='30' x2='20' y2='50' stroke='black' stroke-width='1.5'/%3E%3Cline x1='29' y1='30' x2='29' y2='27' stroke='black' stroke-width='1.5'/%3E%3Cline x1='27' y1='27' x2='31' y2='27' stroke='black' stroke-width='1.2'/%3E%3Ccircle cx='36' cy='40' r='1.2' fill='black'/%3E%3Cline x1='36.5' y1='39.5' x2='38.5' y2='37.5' stroke='black' stroke-width='1'/%3E%3Cline x1='35.5' y1='40.5' x2='33.5' y2='42.5' stroke='black' stroke-width='1'/%3E%3Ccircle cx='36' cy='40' r='2.5' stroke='black' stroke-width='1' fill='none'/%3E%3C/svg%3E">
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-image: url('./attached_assets/image_1752711843788.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      min-height: 100vh;
      color: #333;
      direction: rtl;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.2);
      z-index: -1;
    }

    .header {
      background: #F8F8F8;
      background-image: url('./attached_assets/image_1752711191787.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      padding: 15px 40px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
      position: relative;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(248, 248, 248, 0.2);
      z-index: 1;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
      position: relative;
      z-index: 2;
    }

    .site-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin: 0;
    }

    .nav-links {
      display: flex;
      gap: 30px;
      position: relative;
      z-index: 2;
    }

    .nav-link {
      color: #333;
      text-decoration: none;
      font-size: 16px;
      font-weight: bold;
      transition: color 0.2s;
      cursor: pointer;
    }

    .nav-link:hover {
      color: #748873;
    }

    .main-container {
      padding: 20px;
    }

    .content-section {
      background: #F8F8F8;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 30px;
      margin: 20px auto;
      max-width: 1400px;
    }

    .section-title {
      font-size: 28px;
      font-weight: bold;
      color: #333;
      margin-bottom: 20px;
      text-align: center;
    }

    .section-content {
      line-height: 1.8;
      font-size: 16px;
      color: #555;
    }

    .container {
      display: flex;
      gap: 20px;
      align-items: stretch;
      max-width: 1400px;
      margin: 0 auto;
      height: 600px;
      flex-direction: row-reverse;
    }

    .map-container {
      flex: 2;
      background: #F8F8F8;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 15px;
      position: relative;
      height: 600px;
    }

    .sidebar {
      flex: 1;
      min-width: 320px;
      background: #F8F8F8;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 20px;
      overflow-y: auto;
      height: 600px;
    }

    #map {
      height: 100%;
      width: 100%;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    }

    #route-list {
      margin-top: 15px;
      border: 1px solid #D1A980;
      padding: 15px;
      background: #E5E0D8;
      border-radius: 8px;
      max-height: 200px;
      overflow-y: auto;
    }

    .segment-name-display {
      position: absolute;
      top: 25px;
      right: 25px;
      background: rgba(70, 130, 180, 0.9);
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      font-weight: 600;
      font-size: 14px;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      max-width: 250px;
      word-wrap: break-word;
      display: none;
    }

    .legend-container {
      position: absolute;
      top: 25px;
      left: 25px;
      z-index: 1000;
      direction: rtl;
    }

    .legend-toggle {
      background: #F8F8F8;
      border: none;
      padding: 4px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      transition: all 0.2s;
      margin-bottom: 2px;
      display: block;
      width: auto;
      min-width: 0;
    }

    .legend-toggle:hover {
      background: #e0e0e0;
      transform: translateY(-1px);
    }

    .legend-box {
      background: #F8F8F8;
      border-radius: 4px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      padding: 6px;
      min-width: 0;
      width: auto;
      overflow: hidden;
      transition: all 0.3s ease-in-out;
      transform-origin: top;
    }

    .legend-box.closed {
      max-height: 0;
      padding: 0 6px;
      opacity: 0;
      transform: scaleY(0);
    }

    .legend-box.open {
      max-height: 150px;
      opacity: 1;
      transform: scaleY(1);
    }

    .legend-title {
      font-weight: bold;
      font-size: 11px;
      color: #333;
      margin-bottom: 4px;
      text-align: center;
    }

    .legend-item {
      display: flex;
      align-items: center;
      margin-bottom: 3px;
      gap: 4px;
    }

    .legend-color {
      width: 12px;
      height: 3px;
      border-radius: 1px;
      flex-shrink: 0;
    }

    .legend-label {
      font-size: 10px;
      color: #333;
      font-weight: 500;
      white-space: nowrap;
    }

    .paved-trail {
      background-color: rgb(2, 136, 209);
    }

    .dirt-trail {
      background-color: rgb(85, 139, 47);
    }

    .road {
      background-color: rgb(230, 238, 156);
    }

    #error-message {
      color: #e74c3c;
      margin: 10px 0;
      display: none;
      padding: 10px;
      background: #fdf2f2;
      border: 1px solid #fecaca;
      border-radius: 6px;
    }

    .route-segment {
      cursor: pointer;
    }

    .segment-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid #ddd;
      transition: background-color 0.2s;
    }

    .segment-item:hover {
      background-color: rgba(255, 255, 255, 0.5);
      border-radius: 4px;
      padding-left: 4px;
    }

    .remove-btn {
      background: #8FBC8F;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 11px;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(143, 188, 143, 0.3);
    }

    .remove-btn:hover {
      background: #6B8E23;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(107, 142, 35, 0.4);
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    #download-gpx {
      background: #4682B4;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 4px 16px rgba(70, 130, 180, 0.3);
      flex: 1;
    }

    #download-gpx:disabled {
      background: #cccccc;
      cursor: not-allowed;
      box-shadow: none;
    }

    #download-gpx:hover:not(:disabled) {
      background: #5F9EA0;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(70, 130, 180, 0.4);
    }

    .undo-btn {
      background: #8FBC8F;
      color: white;
      border: none;
      padding: 12px 16px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 4px 16px rgba(143, 188, 143, 0.3);
      min-width: 60px;
    }

    .undo-btn:disabled {
      background: #cccccc;
      cursor: not-allowed;
      box-shadow: none;
    }

    .undo-btn:hover:not(:disabled) {
      background: #6B8E23;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(107, 142, 35, 0.4);
    }

    .mapboxgl-popup.segment-tooltip .mapboxgl-popup-content {
      background-color: rgba(0, 0, 0, 0.9);
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 13px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      pointer-events: none;
    }

    .mapboxgl-popup.segment-tooltip .mapboxgl-popup-tip {
      border-top-color: rgba(0, 0, 0, 0.9);
    }

    .elevation-profile {
      margin-top: 15px;
      padding: 15px;
      background: linear-gradient(135deg, #E6F3E6 0%, #B8D4B8 100%);
      border-radius: 8px;
      border: 1px solid #8FBC8F;
    }

    .elevation-profile h4 {
      margin: 0 0 10px 0;
      color: #333;
      font-size: 14px;
      text-align: center;
    }

    .elevation-chart {
      position: relative;
      height: 80px;
      background: linear-gradient(to top, #6B8E23 0%, #8FBC8F 20%, #E6F3E6 100%);
      border-radius: 4px;
      overflow: hidden;
      margin-bottom: 5px;
    }

    .elevation-point {
      position: absolute;
      bottom: 0;
      width: 2px;
      min-height: 5px;
      border-radius: 1px 1px 0 0;
      cursor: pointer;
      transition: opacity 0.2s;
    }

    .elevation-point:hover {
      opacity: 0.8;
    }

    .elevation-labels {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: #666;
      margin-top: 5px;
    }

    .search-container {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
    }

    #location-search {
      flex: 1;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 25px;
      font-size: 14px;
      transition: border-color 0.2s;
    }

    #location-search:focus {
      outline: none;
      border-color: #2196F3;
    }

    #search-btn {
      background: #4682B4;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 4px 16px rgba(70, 130, 180, 0.3);
    }

    #search-btn:hover {
      background: #5F9EA0;
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(70, 130, 180, 0.4);
    }

    .leaflet-interactive {
      outline: none !important;
    }

    .leaflet-interactive:focus {
      outline: none !important;
    }

    h3 {
      color: #333;
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 1.2em;
      font-weight: 600;
    }

    #route-description {
      background: #4682B4;
      color: white;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      font-size: 14px;
      line-height: 1.4;
    }

    .file-upload-container {
      background: #F8F8F8;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
    }

    #kml-file {
      margin-bottom: 10px;
      padding: 10px;
      border: 2px dashed #ddd;
      border-radius: 8px;
      width: 100%;
      cursor: pointer;
    }

    #kml-file:hover {
      border-color: #2196F3;
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="logo-section">
      <h1 class="site-title">מפת שבילי אופניים - גליל עליון וגולן</h1>
    </div>
    <nav class="nav-links">
      <a class="nav-link" onclick="scrollToSection('trails')">שבילים</a>
      <a class="nav-link" onclick="scrollToSection('equipment')">תכנון מסלול</a>
      <a class="nav-link" onclick="scrollToSection('about')">איך אפשר לעזור</a>
    </nav>
  </header>

  <div class="main-container">
    <div id="error-message"></div>

    <div class="container">
      <div class="map-container">
        <div class="segment-name-display" id="segment-name-display">No segment selected</div>
        <div class="legend-container">
          <button class="legend-toggle" id="legend-toggle">🗺️ מקרא</button>
          <div class="legend-box open" id="legend-box">
            <div class="legend-title">סוגי דרכים</div>
            <div class="legend-item">
              <div class="legend-color paved-trail"></div>
              <div class="legend-label">שביל סלול</div>
            </div>
            <div class="legend-item">
              <div class="legend-color dirt-trail"></div>
              <div class="legend-label">שביל עפר</div>
            </div>
            <div class="legend-item">
              <div class="legend-color road"></div>
              <div class="legend-label">כביש</div>
            </div>
          </div>
        </div>
        <div id="map"></div>
      </div>

      <div class="sidebar">
        <h3>חיפוש מיקום</h3>
        <div class="search-container">
          <input type="text" id="location-search" placeholder="הכנס שם מקום..." />
          <button id="search-btn">חיפוש</button>
        </div>
        <div id="search-error" style="color: red; font-size: 12px; margin-top: 5px; display: none;"></div>

        <h3>קטעי מסלול נבחרים</h3>
        <div id="route-list">
          <p style="color: #666; font-style: italic;">לא נבחרו קטעים. לחץ על קטעי מסלול במפה כדי להוסיף אותם למסלול שלך.
          </p>
        </div>

        <h3>תיאור המסלול</h3>
        <div id="route-description">לחץ על קטעי מפה כדי לבנות את המסלול שלך.</div>

        <div class="action-buttons">
          <button id="undo-btn" class="undo-btn" disabled title="ביטול (Ctrl+Z)">↶</button>
          <button id="redo-btn" class="undo-btn" disabled title="חזרה (Ctrl+Shift+Z)">↷</button>
          <button id="download-gpx" disabled>הורדת מסלול GPX</button>
        </div>
      </div>
    </div>

    <div class="content-section" id="trails">
      <h2 class="section-title">מסלולי אופניים</h2>
      <div class="section-content">
        <p>הרי הגליל העליון מציעים חוויית רכיבה מגוונת ומאתגרת עבור רוכבי אופניים בכל הרמות. האזור כולל מסלולים מתאימים
          הן למתחילים והן לרוכבים מנוסים, עם נופים עוצרי נשימה וטבע פראי מדהים.</p>

        <p>המסלולים מחולקים לקטגוריות שונות: מסלולי משפחה קלים הנמשכים 5-10 קילומטרים, מסלולים בינוניים לרוכבים עם
          ניסיון בסיסי באורך 15-25 קילומטר, ומסלולים מתקדמים למומחים באורך של 30 קילומטר ומעלה עם עליות תלולות ושטח
          טכני.</p>

        <p>כל מסלול מסומן בבירור עם שילוט מתאים ומציע תצפיות מרהיבות על הכנרת, רמת הגולן והרי לבנון. לאורך המסלולים ניתן
          למצוא נקודות מנוחה, מעיינות טבעיים ואתרים היסטוריים מעניינים.</p>
      </div>
    </div>

    <div class="content-section" id="equipment">
      <h2 class="section-title">ציוד ומידע טכני</h2>
      <div class="section-content">
        <p>לרכיבה בטוחה ומהנה בגליל העליון חשוב להיערך עם הציוד המתאים. קסדה היא חובה בכל המסלולים, וכן מומלץ על לבוש
          מתאים למזג האוויר ונעלי רכיבה נוחות.</p>

        <p>האופניים המתאימים ביותר למסלולים הם אופני הרים (MTB) עם מערכת הילוכים מתאימה לעליות תלולות. מומלץ לבדוק את
          מצב הבלמים והצמיגים לפני היציאה למסלול. כמו כן, חשוב לקחת איתכם מים בכמות מספקת, חטיפי אנרגיה וערכת תיקונים
          בסיסית.</p>

        <p>בעונות החורף מומלץ לבדוק את תנאי מזג האוויר ומצב השבילים לפני היציאה. חלק מהמסלולים עלולים להיות בלתי עבירים
          בתקופות של גשמים כבדים. תמיד עדכנו מישהו על תוכניות הרכיבה שלכם ושמרו על ערוץ תקשורת פתוח.</p>
      </div>
    </div>

    <div class="content-section" id="about">
      <h2 class="section-title">עזרה ומידע נוסף</h2>
      <div class="section-content">
        <p>מתכנן המסלולים שלנו מאפשר לכם ליצור מסלולי רכיבה מותאמים אישית על ידי בחירת קטעי דרך שונים. לחצו על קטעי
          המסלול במפה כדי להוסיף אותם למסלול שלכם, וקבלו תיאור מפורט עם מרחק, עליות וירידות.</p>

        <p>המערכת מאפשרת לכם להוריד קובץ GPX של המסלול שבניתם, אותו תוכלו להעלות לאפליקציית הניווט המועדפת עליכם כמו
          Strava, Komoot או Garmin Connect. כל קטע מסלול מכיל מידע מדויק על המרחק, רמת הקושי והגובה.</p>

        <p>לשאלות נוספות, הצעות לשיפור או דיווח על בעיות טכניות, ניתן ליצור איתנו קשר. אנו פועלים כדי לשפר ולהרחיב ללא
          הרף את מאגר המסלולים ולספק לכם את החוויה הטובה ביותר ברכיבה על אופניים בגליל העליון.</p>
      </div>
    </div>
  </div>

  <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
  <script src="script.js"></script>
</body>

</html>